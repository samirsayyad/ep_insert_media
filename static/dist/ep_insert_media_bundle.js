"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}Object.defineProperty(exports,"__esModule",{value:!0});var t="object"==("undefined"==typeof self?"undefined":e(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":e(global))&&global.global===global&&global||Function("return this")()||{},n=Array.prototype,r=Object.prototype,i="undefined"!=typeof Symbol?Symbol.prototype:null,a=n.push,o=n.slice,u=r.toString,c=r.hasOwnProperty,s="undefined"!=typeof ArrayBuffer,l="undefined"!=typeof DataView,f=Array.isArray,d=Object.keys,p=Object.create,m=s&&ArrayBuffer.isView,v=isNaN,h=isFinite,g=!{toString:null}.propertyIsEnumerable("toString"),b=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],y=Math.pow(2,53)-1;function _(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var a=Array(t+1);for(i=0;i<t;i++)a[i]=arguments[i];return a[t]=r,e.apply(this,a)}}function w(t){var n=e(t);return"function"===n||"object"===n&&!!t}function S(e){return void 0===e}function A(e){return!0===e||!1===e||"[object Boolean]"===u.call(e)}function M(e){var t="[object "+e+"]";return function(e){return u.call(e)===t}}var E=M("String"),x=M("Number"),j=M("Date"),O=M("RegExp"),N=M("Error"),R=M("Symbol"),C=M("ArrayBuffer"),T=M("Function"),D=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":e(Int8Array))&&"function"!=typeof D&&(T=function(e){return"function"==typeof e||!1});var z=T,I=M("Object"),k=l&&I(new DataView(new ArrayBuffer(8))),P="undefined"!=typeof Map&&I(new Map),V=M("DataView");var L=k?function(e){return null!=e&&z(e.getInt8)&&C(e.buffer)}:V,F=f||M("Array");function J(e,t){return null!=e&&c.call(e,t)}var B=M("Arguments");!function(){B(arguments)||(B=function(e){return J(e,"callee")})}();var W=B;function q(e){return x(e)&&v(e)}function H(e){return function(){return e}}function U(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=y}}function Z(e){return function(t){return null==t?void 0:t[e]}}var K=Z("byteLength"),Y=U(K),G=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Q=s?function(e){return m?m(e)&&!L(e):Y(e)&&G.test(u.call(e))}:H(!1),X=Z("length");function ee(e,t){t=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(e){return!0===t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var n=b.length,i=e.constructor,a=z(i)&&i.prototype||r,o="constructor";for(J(e,o)&&!t.contains(o)&&t.push(o);n--;)(o=b[n])in e&&e[o]!==a[o]&&!t.contains(o)&&t.push(o)}function te(e){if(!w(e))return[];if(d)return d(e);var t=[];for(var n in e)J(e,n)&&t.push(n);return g&&ee(e,t),t}function ne(e){if(null==e)return!0;var t=X(e);return"number"==typeof t&&(F(e)||E(e)||W(e))?0===t:0===X(te(e))}function re(e,t){var n=te(t),r=n.length;if(null==e)return!r;for(var i=Object(e),a=0;a<r;a++){var o=n[a];if(t[o]!==i[o]||!(o in i))return!1}return!0}function ie(e){return e instanceof ie?e:this instanceof ie?void(this._wrapped=e):new ie(e)}function ae(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,K(e))}ie.VERSION="1.13.4",ie.prototype.value=function(){return this._wrapped},ie.prototype.valueOf=ie.prototype.toJSON=ie.prototype.value,ie.prototype.toString=function(){return String(this._wrapped)};function oe(t,n,r,i){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return!1;if(t!=t)return n!=n;var a=e(t);return("function"===a||"object"===a||"object"==e(n))&&ue(t,n,r,i)}function ue(t,n,r,a){t instanceof ie&&(t=t._wrapped),n instanceof ie&&(n=n._wrapped);var o=u.call(t);if(o!==u.call(n))return!1;if(k&&"[object Object]"==o&&L(t)){if(!L(n))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return i.valueOf.call(t)===i.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return ue(ae(t),ae(n),r,a)}var c="[object Array]"===o;if(!c&&Q(t)){if(K(t)!==K(n))return!1;if(t.buffer===n.buffer&&t.byteOffset===n.byteOffset)return!0;c=!0}if(!c){if("object"!=e(t)||"object"!=e(n))return!1;var s=t.constructor,l=n.constructor;if(s!==l&&!(z(s)&&s instanceof s&&z(l)&&l instanceof l)&&"constructor"in t&&"constructor"in n)return!1}a=a||[];for(var f=(r=r||[]).length;f--;)if(r[f]===t)return a[f]===n;if(r.push(t),a.push(n),c){if((f=t.length)!==n.length)return!1;for(;f--;)if(!oe(t[f],n[f],r,a))return!1}else{var d,p=te(t);if(f=p.length,te(n).length!==f)return!1;for(;f--;)if(!J(n,d=p[f])||!oe(t[d],n[d],r,a))return!1}return r.pop(),a.pop(),!0}function ce(e){if(!w(e))return[];var t=[];for(var n in e)t.push(n);return g&&ee(e,t),t}function se(e){var t=X(e);return function(n){if(null==n)return!1;var r=ce(n);if(X(r))return!1;for(var i=0;i<t;i++)if(!z(n[e[i]]))return!1;return e!==me||!z(n[le])}}var le="forEach",fe=["clear","delete"],de=["get","has","set"],pe=fe.concat(le,de),me=fe.concat(de),ve=["add"].concat(fe,le,"has"),he=P?se(pe):M("Map"),ge=P?se(me):M("WeakMap"),be=P?se(ve):M("Set"),ye=M("WeakSet");function _e(e){for(var t=te(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function $e(e){for(var t={},n=te(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function we(e){var t=[];for(var n in e)z(e[n])&&t.push(n);return t.sort()}function Se(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var a=arguments[i],o=e(a),u=o.length,c=0;c<u;c++){var s=o[c];t&&void 0!==n[s]||(n[s]=a[s])}return n}}var Ae=Se(ce),Me=Se(te),Ee=Se(ce,!0);function xe(e){if(!w(e))return{};if(p)return p(e);var t=function(){};t.prototype=e;var n=new t;return t.prototype=null,n}function je(e){return F(e)?e:[e]}function Oe(e){return ie.toPath(e)}function Ne(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0}function Re(e,t,n){var r=Ne(e,Oe(t));return S(r)?n:r}function Ce(e){return e}function Te(e){return e=Me({},e),function(t){return re(t,e)}}function De(e){return e=Oe(e),function(t){return Ne(t,e)}}function ze(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,a){return e.call(t,n,r,i,a)}}return function(){return e.apply(t,arguments)}}function Ie(e,t,n){return null==e?Ce:z(e)?ze(e,t,n):w(e)&&!F(e)?Te(e):De(e)}function ke(e,t){return Ie(e,t,1/0)}function Pe(e,t,n){return ie.iteratee!==ke?ie.iteratee(e,t):Ie(e,t,n)}function Ve(){}function Le(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}ie.toPath=je,ie.iteratee=ke;var Fe=Date.now||function(){return(new Date).getTime()};function Je(e){var t=function(t){return e[t]},n="(?:"+te(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}}var Be={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},We=Je(Be),qe=Je($e(Be)),He=ie.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ue=/(.)^/,Ze={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ke=/\\|'|\r|\n|\u2028|\u2029/g;function Ye(e){return"\\"+Ze[e]}var Ge=/^\s*(\w|\$)+\s*$/;var Qe=0;function Xe(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var a=xe(e.prototype),o=e.apply(a,i);return w(o)?o:a}var et=_((function(e,t){var n=et.placeholder;return function r(){for(var i=0,a=t.length,o=Array(a),u=0;u<a;u++)o[u]=t[u]===n?arguments[i++]:t[u];for(;i<arguments.length;)o.push(arguments[i++]);return Xe(e,r,this,this,o)}}));et.placeholder=ie;var tt=_((function(e,t,n){if(!z(e))throw new TypeError("Bind must be called on a function");var r=_((function(i){return Xe(e,r,t,this,n.concat(i))}));return r})),nt=U(X);function rt(e,t,n,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var i=r.length,a=0,o=X(e);a<o;a++){var u=e[a];if(nt(u)&&(F(u)||W(u)))if(t>1)rt(u,t-1,n,r),i=r.length;else for(var c=0,s=u.length;c<s;)r[i++]=u[c++];else n||(r[i++]=u)}return r}var it=_((function(e,t){var n=(t=rt(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=tt(e[r],e)}return e}));var at=_((function(e,t,n){return setTimeout((function(){return e.apply(null,n)}),t)})),ot=et(at,ie,1);function ut(e){return function(){return!e.apply(this,arguments)}}function ct(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var st=et(ct,2);function lt(e,t,n){t=Pe(t,n);for(var r,i=te(e),a=0,o=i.length;a<o;a++)if(t(e[r=i[a]],r,e))return r}function ft(e){return function(t,n,r){n=Pe(n,r);for(var i=X(t),a=e>0?0:i-1;a>=0&&a<i;a+=e)if(n(t[a],a,t))return a;return-1}}var dt=ft(1),pt=ft(-1);function mt(e,t,n,r){for(var i=(n=Pe(n,r,1))(t),a=0,o=X(e);a<o;){var u=Math.floor((a+o)/2);n(e[u])<i?a=u+1:o=u}return a}function vt(e,t,n){return function(r,i,a){var u=0,c=X(r);if("number"==typeof a)e>0?u=a>=0?a:Math.max(a+c,u):c=a>=0?Math.min(a+1,c):a+c+1;else if(n&&a&&c)return r[a=n(r,i)]===i?a:-1;if(i!=i)return(a=t(o.call(r,u,c),q))>=0?a+u:-1;for(a=e>0?u:c-1;a>=0&&a<c;a+=e)if(r[a]===i)return a;return-1}}var ht=vt(1,dt,mt),gt=vt(-1,pt);function bt(e,t,n){var r=(nt(e)?dt:lt)(e,t,n);if(void 0!==r&&-1!==r)return e[r]}function yt(e,t,n){var r,i;if(t=ze(t,n),nt(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var a=te(e);for(r=0,i=a.length;r<i;r++)t(e[a[r]],a[r],e)}return e}function _t(e,t,n){t=Pe(t,n);for(var r=!nt(e)&&te(e),i=(r||e).length,a=Array(i),o=0;o<i;o++){var u=r?r[o]:o;a[o]=t(e[u],u,e)}return a}function $t(e){var t=function(t,n,r,i){var a=!nt(t)&&te(t),o=(a||t).length,u=e>0?0:o-1;for(i||(r=t[a?a[u]:u],u+=e);u>=0&&u<o;u+=e){var c=a?a[u]:u;r=n(r,t[c],c,t)}return r};return function(e,n,r,i){var a=arguments.length>=3;return t(e,ze(n,i,4),r,a)}}var wt=$t(1),St=$t(-1);function At(e,t,n){var r=[];return t=Pe(t,n),yt(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function Mt(e,t,n){t=Pe(t,n);for(var r=!nt(e)&&te(e),i=(r||e).length,a=0;a<i;a++){var o=r?r[a]:a;if(!t(e[o],o,e))return!1}return!0}function Et(e,t,n){t=Pe(t,n);for(var r=!nt(e)&&te(e),i=(r||e).length,a=0;a<i;a++){var o=r?r[a]:a;if(t(e[o],o,e))return!0}return!1}function xt(e,t,n,r){return nt(e)||(e=_e(e)),("number"!=typeof n||r)&&(n=0),ht(e,t,n)>=0}var jt=_((function(e,t,n){var r,i;return z(t)?i=t:(t=Oe(t),r=t.slice(0,-1),t=t[t.length-1]),_t(e,(function(e){var a=i;if(!a){if(r&&r.length&&(e=Ne(e,r)),null==e)return;a=e[t]}return null==a?a:a.apply(e,n)}))}));function Ot(e,t){return _t(e,De(t))}function Nt(t,n,r){var i,a,o=-1/0,u=-1/0;if(null==n||"number"==typeof n&&"object"!=e(t[0])&&null!=t)for(var c=0,s=(t=nt(t)?t:_e(t)).length;c<s;c++)null!=(i=t[c])&&i>o&&(o=i);else n=Pe(n,r),yt(t,(function(e,t,r){((a=n(e,t,r))>u||a===-1/0&&o===-1/0)&&(o=e,u=a)}));return o}var Rt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ct(e){return e?F(e)?o.call(e):E(e)?e.match(Rt):nt(e)?_t(e,Ce):_e(e):[]}function Tt(e,t,n){if(null==t||n)return nt(e)||(e=_e(e)),e[Le(e.length-1)];var r=Ct(e),i=X(r);t=Math.max(Math.min(t,i),0);for(var a=i-1,o=0;o<t;o++){var u=Le(o,a),c=r[o];r[o]=r[u],r[u]=c}return r.slice(0,t)}function Dt(e,t){return function(n,r,i){var a=t?[[],[]]:{};return r=Pe(r,i),yt(n,(function(t,i){var o=r(t,i,n);e(a,t,o)})),a}}var zt=Dt((function(e,t,n){J(e,n)?e[n].push(t):e[n]=[t]})),It=Dt((function(e,t,n){e[n]=t})),kt=Dt((function(e,t,n){J(e,n)?e[n]++:e[n]=1})),Pt=Dt((function(e,t,n){e[n?0:1].push(t)}),!0);function Vt(e,t,n){return t in n}var Lt=_((function(e,t){var n={},r=t[0];if(null==e)return n;z(r)?(t.length>1&&(r=ze(r,t[1])),t=ce(e)):(r=Vt,t=rt(t,!1,!1),e=Object(e));for(var i=0,a=t.length;i<a;i++){var o=t[i],u=e[o];r(u,o,e)&&(n[o]=u)}return n})),Ft=_((function(e,t){var n,r=t[0];return z(r)?(r=ut(r),t.length>1&&(n=t[1])):(t=_t(rt(t,!1,!1),String),r=function(e,n){return!xt(t,n)}),Lt(e,r,n)}));function Jt(e,t,n){return o.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Bt(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:Jt(e,e.length-t)}function Wt(e,t,n){return o.call(e,null==t||n?1:t)}var qt=_((function(e,t){return t=rt(t,!0,!0),At(e,(function(e){return!xt(t,e)}))})),Ht=_((function(e,t){return qt(e,t)}));function Ut(e,t,n,r){A(t)||(r=n,n=t,t=!1),null!=n&&(n=Pe(n,r));for(var i=[],a=[],o=0,u=X(e);o<u;o++){var c=e[o],s=n?n(c,o,e):c;t&&!n?(o&&a===s||i.push(c),a=s):n?xt(a,s)||(a.push(s),i.push(c)):xt(i,c)||i.push(c)}return i}var Zt=_((function(e){return Ut(rt(e,!0,!0))}));function Kt(e){for(var t=e&&Nt(e,X).length||0,n=Array(t),r=0;r<t;r++)n[r]=Ot(e,r);return n}var Yt=_(Kt);function Gt(e,t){for(var n={},r=0,i=X(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n}function Qt(e,t){return e._chain?ie(t).chain():t}function Xt(e){return yt(we(e),(function(t){var n=ie[t]=e[t];ie.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),Qt(this,n.apply(ie,e))}})),ie}yt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=n[e];ie.prototype[e]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0]),Qt(this,n)}})),yt(["concat","join","slice"],(function(e){var t=n[e];ie.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Qt(this,e)}}));var en=Object.freeze({__proto__:null,VERSION:"1.13.4",restArguments:_,isObject:w,isNull:function(e){return null===e},isUndefined:S,isBoolean:A,isElement:function(e){return!(!e||1!==e.nodeType)},isString:E,isNumber:x,isDate:j,isRegExp:O,isError:N,isSymbol:R,isArrayBuffer:C,isDataView:L,isArray:F,isFunction:z,isArguments:W,isFinite:function(e){return!R(e)&&h(e)&&!isNaN(parseFloat(e))},isNaN:q,isTypedArray:Q,isEmpty:ne,isMatch:re,isEqual:function(e,t){return oe(e,t)},isMap:he,isWeakMap:ge,isSet:be,isWeakSet:ye,keys:te,allKeys:ce,values:_e,pairs:function(e){for(var t=te(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},invert:$e,functions:we,methods:we,extend:Ae,extendOwn:Me,assign:Me,defaults:Ee,create:function(e,t){var n=xe(e);return t&&Me(n,t),n},clone:function(e){return w(e)?F(e)?e.slice():Ae({},e):e},tap:function(e,t){return t(e),e},get:Re,has:function(e,t){for(var n=(t=Oe(t)).length,r=0;r<n;r++){var i=t[r];if(!J(e,i))return!1;e=e[i]}return!!n},mapObject:function(e,t,n){t=Pe(t,n);for(var r=te(e),i=r.length,a={},o=0;o<i;o++){var u=r[o];a[u]=t(e[u],u,e)}return a},identity:Ce,constant:H,noop:Ve,toPath:je,property:De,propertyOf:function(e){return null==e?Ve:function(t){return Re(e,t)}},matcher:Te,matches:Te,times:function(e,t,n){var r=Array(Math.max(0,e));t=ze(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},random:Le,now:Fe,escape:We,unescape:qe,templateSettings:He,template:function(e,t,n){!t&&n&&(t=n),t=Ee({},t,ie.templateSettings);var r=RegExp([(t.escape||Ue).source,(t.interpolate||Ue).source,(t.evaluate||Ue).source].join("|")+"|$","g"),i=0,a="__p+='";e.replace(r,(function(t,n,r,o,u){return a+=e.slice(i,u).replace(Ke,Ye),i=u+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),t})),a+="';\n";var o,u=t.variable;if(u){if(!Ge.test(u))throw new Error("variable is not a bare identifier: "+u)}else a="with(obj||{}){\n"+a+"}\n",u="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{o=new Function(u,"_",a)}catch(e){throw e.source=a,e}var c=function(e){return o.call(this,e,ie)};return c.source="function("+u+"){\n"+a+"}",c},result:function(e,t,n){var r=(t=Oe(t)).length;if(!r)return z(n)?n.call(e):n;for(var i=0;i<r;i++){var a=null==e?void 0:e[t[i]];void 0===a&&(a=n,i=r),e=z(a)?a.call(e):a}return e},uniqueId:function(e){var t=++Qe+"";return e?e+t:t},chain:function(e){var t=ie(e);return t._chain=!0,t},iteratee:ke,partial:et,bind:tt,bindAll:it,memoize:function(e,t){var n=function n(r){var i=n.cache,a=""+(t?t.apply(this,arguments):r);return J(i,a)||(i[a]=e.apply(this,arguments)),i[a]};return n.cache={},n},delay:at,defer:ot,throttle:function(e,t,n){var r,i,a,o,u=0;n||(n={});var c=function(){u=!1===n.leading?0:Fe(),r=null,o=e.apply(i,a),r||(i=a=null)},s=function(){var s=Fe();u||!1!==n.leading||(u=s);var l=t-(s-u);return i=this,a=arguments,l<=0||l>t?(r&&(clearTimeout(r),r=null),u=s,o=e.apply(i,a),r||(i=a=null)):r||!1===n.trailing||(r=setTimeout(c,l)),o};return s.cancel=function(){clearTimeout(r),u=0,r=i=a=null},s},debounce:function(e,t,n){var r,i,a,o,u,c=function c(){var s=Fe()-i;t>s?r=setTimeout(c,t-s):(r=null,n||(o=e.apply(u,a)),r||(a=u=null))},s=_((function(s){return u=this,a=s,i=Fe(),r||(r=setTimeout(c,t),n&&(o=e.apply(u,a))),o}));return s.cancel=function(){clearTimeout(r),r=a=u=null},s},wrap:function(e,t){return et(t,e)},negate:ut,compose:function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:ct,once:st,findKey:lt,findIndex:dt,findLastIndex:pt,sortedIndex:mt,indexOf:ht,lastIndexOf:gt,find:bt,detect:bt,findWhere:function(e,t){return bt(e,Te(t))},each:yt,forEach:yt,map:_t,collect:_t,reduce:wt,foldl:wt,inject:wt,reduceRight:St,foldr:St,filter:At,select:At,reject:function(e,t,n){return At(e,ut(Pe(t)),n)},every:Mt,all:Mt,some:Et,any:Et,contains:xt,includes:xt,include:xt,invoke:jt,pluck:Ot,where:function(e,t){return At(e,Te(t))},max:Nt,min:function(t,n,r){var i,a,o=1/0,u=1/0;if(null==n||"number"==typeof n&&"object"!=e(t[0])&&null!=t)for(var c=0,s=(t=nt(t)?t:_e(t)).length;c<s;c++)null!=(i=t[c])&&i<o&&(o=i);else n=Pe(n,r),yt(t,(function(e,t,r){((a=n(e,t,r))<u||a===1/0&&o===1/0)&&(o=e,u=a)}));return o},shuffle:function(e){return Tt(e,1/0)},sample:Tt,sortBy:function(e,t,n){var r=0;return t=Pe(t,n),Ot(_t(e,(function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}})).sort((function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index})),"value")},groupBy:zt,indexBy:It,countBy:kt,partition:Pt,toArray:Ct,size:function(e){return null==e?0:nt(e)?e.length:te(e).length},pick:Lt,omit:Ft,first:Bt,head:Bt,take:Bt,initial:Jt,last:function(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:Wt(e,Math.max(0,e.length-t))},rest:Wt,tail:Wt,drop:Wt,compact:function(e){return At(e,Boolean)},flatten:function(e,t){return rt(e,t,!1)},without:Ht,uniq:Ut,unique:Ut,union:Zt,intersection:function(e){for(var t=[],n=arguments.length,r=0,i=X(e);r<i;r++){var a=e[r];if(!xt(t,a)){var o;for(o=1;o<n&&xt(arguments[o],a);o++);o===n&&t.push(a)}}return t},difference:qt,unzip:Kt,transpose:Kt,zip:Yt,object:Gt,range:function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),a=0;a<r;a++,e+=n)i[a]=e;return i},chunk:function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(o.call(e,r,r+=t));return n},mixin:Xt,default:ie}),tn=Xt(en);tn._=tn;const nn=(e,t,n)=>e!==n?0:t.selStart[1],rn=(e,t,n)=>{let r;return r=e!==n?((e,t)=>{const n=e+1,r=t.lines.offsetOfIndex(e);return t.lines.offsetOfIndex(n)-r-1})(e,t):t.selEnd[1]-1,r},an=(e,t,n,r)=>{let i=!1;for(let a=t;a<=n&&!i;a++){const t=Gt(r.getAttributesOnPosition(e,a)).embedMedia,n=Gt(r.getAttributesOnPosition(e,a)).insertEmbedPicture,o=Gt(r.getAttributesOnPosition(e,a)).insertEmbedVideo,u=Gt(r.getAttributesOnPosition(e,a)).insertEmbedAudio;console.info(t,r.getAttributesOnPosition(e,a)),void 0!==t&&(i={elemenet:"embedMedia",data:t}),void 0!==n&&(i={elemenet:"insertEmbedPicture",data:n}),void 0!==o&&(i={elemenet:"insertEmbedVideo",data:o}),void 0!==u&&(i={elemenet:"insertEmbedAudio",data:u})}return i},on=e=>$(e).html(),un=(e,t)=>{const n=(e=>{const t=[];let n;for(;"div"!==$(e)[0].localName;){const r=$(e).prop("outerHTML"),i=/<(b|i|u|s|div|img)>/.exec(r);n=i?i[1]:"",t.push(n),e=$(e).parent()}return t})(t.commonAncestorContainer.parentNode);return n&&(e=(e=>{let t="";return e.forEach((e=>{t+=`<${e}>`})),t})(n)+e+(e=>{let t="";for(const n of e.slice().reverse())t+=`</${n}>`;return t})(n)),e},cn=e=>(e=>{const t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue})(on(e))===$(e).text(),sn=(e,t,n)=>{const r=e.originalEvent.clipboardData.getData("text/objectMediaDataHtml");let i=e.originalEvent.clipboardData.getData("text/objectMediaData");if(r&&i){i=JSON.parse(i);let t=JSON.parse(r);t=$("<div></div>").append(t.raw);let a=0;t.find(".embedRemoteImageSpan").each((function(){const e=btoa(i.insertEmbedPicture[a]);$(this).attr({id:`emb_img-${e}`}),$(this).attr({class:`emb_img-${e}`}),$(this).empty(),$(this).text("E"),a++})),a=0,t.find(".embedMedia").each((function(){const e=btoa(i.embedMedia[a]);$(this).attr({id:`emb_embedMedia-${e}`}),$(this).attr({class:`emb_embedMedia-${e}`}),$(this).empty(),$(this).text("E"),a++})),a=0,t.find(".embedRemoteVideoSpan").each((function(){const e=btoa(i.insertEmbedVideo[a]);$(this).attr({id:`emb_video-${e}`}),$(this).attr({class:`emb_video-${e}`}),$(this).empty(),$(this).text("E"),a++})),a=0,t.find(".embedRemoteAudioSpan").each((function(){const e=btoa(i.insertEmbedAudio[a]);$(this).attr({id:`emb_audio-${e}`}),$(this).attr({class:`emb_audio-${e}`}),$(this).empty(),$(this).text("E"),a++}));const o=n.contents()[0].getSelection();if(!o.rangeCount)return!1;o.getRangeAt(0).insertNode(t[0]),e.preventDefault()}},ln=(e,t,n)=>{let r;if(t.callWithAce((e=>{r=e.ace_hasMediaOnSelection()})),r){const t=n.contents()[0].getSelection().getRangeAt(0),i=(e=>{const t=e.cloneContents(),n=document.createElement("div");return $(n).html(t)})(t);let a=i;if(cn(i)){a=((e,t)=>{const n=(e=>`<span class="media">${e.slice(0,-1)}</span><span class="media">${e.slice(-1)}</span>`)(e),r=un(n,t);return $.parseHTML(`<div>${r}</div>`)})(i[0].textContent,t)}e.originalEvent.clipboardData.setData("text/objectMediaDataHtml",JSON.stringify({raw:on(a)})),e.originalEvent.clipboardData.setData("text/objectMediaData",JSON.stringify(r)),e.preventDefault()}},fn=e=>{const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let n="";e=e||20;for(let r=0;r<e;r++){const e=Math.floor(Math.random()*t.length);n+=t.substring(e,e+1)}return n},dn=(e,t)=>{let n="175";"Medium"===t.size?n="350":"Large"===t.size&&(n="540");const r=`\n    <samdiv style='height:${n}px' id='emb_embedMedia-${fn(16)}' class='embedMedia'>\n      <samdiv class='media'>\n        ${((e,t)=>{const n=new URL(e);switch(n.host){case"www.youtube.com":case"youtube.com":case"youtu.be":case"www.youtu.be":return`\n        <iframe\n          type="text/html"\n          class="video ep_insert_media_${t.size} ep_insert_media_${t.align}"\n          src="https://www.youtube.com/embed/${(e=>{const t={};return e.split("?")[1].split("&").map((e=>{e=e.split("="),t[e[0]]=e[1]})),t})(e).v}?enablejsapi=1&origin=https://docs.plus"\n          frameborder="0"\n          allow="accelerometer; autoplay;encrypted-media; gyroscope; picture-in-picture"\n          allowfullscreen\n        >\n        </iframe>`;case"vimeo.com":case"www.vimeo.com":return`<iframe   class="video" src="http://player.vimeo.com/video${n.pathname}?color=ffffff"\n       frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>`;default:return'<img loading="lazy" src="/static/plugins/ep_insert_media/static/html/invalid.png">'}})(unescape(t.url),t)}\n      </samdiv>\n    <samdiv class='character'>`;return[{cls:e,extraOpenTags:r,extraCloseTags:"</samdiv>"}]},pn=(e,{size:t,align:n,url:r})=>{const i=`\n  <samdiv\n    data-size='${t}'\n    data-align='${n}'\n    data-url='${unescape(r)}'\n    id='emb_img-${fn(16)}'\n    class='embedRemoteImageSpan'\n  >\n    <samdiv class='image'>\n      ${((e,t,n)=>`<img  loading='auto' class='embedRemoteImage ep_insert_media_${t} ep_insert_media_${n}' src='${$.trim(e)}'>`)(unescape(r),n,t)}\n    </samdiv>\n  <samdiv class='character'>`;return[{cls:e,extraOpenTags:i,extraCloseTags:"</samdiv>"}]},mn=(e,t)=>{const n=t.url,r=`\n    <samdiv\n      data-url='${unescape(n)}'\n      id='emb_video-${fn(16)}'\n      class='embedRemoteVideoSpan'\n    >\n      <samdiv class='video'>\n        ${((e,t)=>{const n=$.trim(e),{size:r,align:i}=t;return`\n    <video class="videoClass ep_insert_media_${r} ep_insert_media_${i}" controls>\n      <source src="${n}" type="video/mp4">\n    </video>\n  `})(unescape(n),t)}\n      </samdiv>\n    <samdiv class='character'>\n  `;return[{cls:e,extraOpenTags:r,extraCloseTags:"</samdiv>"}]},vn=(e,t)=>{const n=t.url,r=`\n    <samdiv\n      data-url='${unescape(n)}'\n      id='emb_audio-${fn(16)}'\n      class='embedRemoteAudioSpan'\n    >\n      <samdiv class='audio'>\n        ${((e,t)=>{const n=$.trim(e),{size:r,align:i}=t;return`\n    <audio class="audioClass ep_insert_media_${r} ep_insert_media_${i}" controls>\n      <source src="${n}" type="audio/mpeg">\n    </video>\n  `})(unescape(n),t)}\n      </samdiv>\n    <samdiv class='character'>`;return[{cls:e,extraOpenTags:r,extraCloseTags:"</samdiv>"}]},hn=(e,t)=>{const n=((e,t,n)=>{let r="175";return"Medium"===n?r="350":"Large"===n&&(r="540"),`\n  <object\n    loading='lazy'\n    data='${$.trim(e)}'\n    class='embedRemoteImage ep_insert_media_${t} ep_insert_media_${n}'\n    type="image/svg+xml"\n    id="alphasvg"\n    width="${r}"\n    height="${r}"\n  >\n  </object>`})("/static/plugins/ep_insert_media/static/images/spinner.svg",t.align,t.size);return[{cls:e,extraOpenTags:`\n    <samdiv\n      data-size='${t.size}'\n      data-align='${t.align}'\n      data-url='/static/plugins/ep_insert_media/static/images/loading.gif'\n      id='media_loading'\n      class='embedRemoteImageSpan'\n    >\n      <samdiv class='image'>\n        ${n}\n      </samdiv>\n    <samdiv class='character'>\n  `,extraCloseTags:"</samdiv>"}]},gn=function(){let e;const t=this.documentAttributeManager,n=this.rep,r=n.selStart[0],i=n.selStart[1],a=n.selEnd[1],o=n.selEnd[0];return e=r!==o?((e,t,n,r)=>{let i={};for(let a=e;a<=t;a++){const o=nn(a,n,e),u=rn(a,n,t),c=an(a,o,u,r);c&&(i[c.elemenet]||(i[c.elemenet]=[]),i[c.elemenet].push(c.data))}return ne(i)&&(i=!1),i})(r,o,n,t):an(r,i,a,t),e},bn=(e,t)=>{const n=[],r=t.contents().find(e);return $.each(r,((e,t)=>{const r=[[],[]],i=$(t).closest("samdiv"),a=$(i).prevAll("samdiv").length;r[0][0]=a,r[1][0]=a,n.push(r)})),n};exports.aceAttribsToClasses=(e,t)=>"embedMedia"===t.key&&""!==t.value?["ep_insert_media",JSON.stringify({func:"embedMedia",data:t.value})]:"insertEmbedPicture"===t.key&&""!==t.value?["ep_insert_media",JSON.stringify({func:"insertEmbedPicture",data:t.value})]:"insertEmbedVideo"===t.key&&""!==t.value?["ep_insert_media",JSON.stringify({func:"insertEmbedVideo",data:t.value})]:"insertEmbedAudio"===t.key&&""!==t.value?["ep_insert_media",JSON.stringify({func:"insertEmbedAudio",data:t.value})]:"insertMediaLoading"===t.key&&""!==t.value?["ep_insert_media",JSON.stringify({func:"insertMediaLoading",data:t.value})]:[],exports.aceCreateDomLine=(e,t)=>{try{const e=t.cls.split(" ");if(e.length<2)return[];if("ep_insert_media"!==e[1])return[];const n=JSON.parse(e[2]),r=JSON.parse(n.data);switch(n.func){case"embedMedia":return dn(t.cls,r);case"insertEmbedPicture":return pn(t.cls,r);case"insertEmbedVideo":return mn(t.cls,r);case"insertEmbedAudio":return vn(t.cls,r);case"insertMediaLoading":return hn(t.cls,r);default:return[]}}catch(e){console.error(e)}},exports.aceInitInnerdocbodyHead=(e,t)=>(t.iframeHTML.push('<link rel="stylesheet" type="text/css" href="/static/plugins/ep_insert_media/static/css/ace.css"/>'),[]),exports.aceInitialized=(e,t)=>{const n=t.editorInfo;return n.ace_hasMediaOnSelection=gn.bind(t),n.ace_getRepFromSelector=bn.bind(t),[]},exports.collectContentPre=(e,t)=>{let n=/(?:^| )emb_img-([A-Za-z0-9]*)/.exec(t.cls);return n&&n[1]&&t.cc.doAttrib(t.state,`insertEmbedPicture::${atob(n[1])}`),n=/(?:^| )emb_embedMedia-([A-Za-z0-9]*)/.exec(t.cls),n&&n[1]&&t.cc.doAttrib(t.state,`embedMedia::${atob(n[1])}`),n=/(?:^| )emb_video-([A-Za-z0-9]*)/.exec(t.cls),n&&n[1]&&t.cc.doAttrib(t.state,`insertEmbedVideo::${atob(n[1])}`),n=/(?:^| )emb_audio-([A-Za-z0-9]*)/.exec(t.cls),n&&n[1]&&t.cc.doAttrib(t.state,`insertEmbedAudio::${atob(n[1])}`),[]},exports.documentReady=(e,t)=>{const n=e=>{require("ep_etherpad-lite/static/js/pad_editor").padeditor.ace.callWithAce((t=>{const n=t.ace_getRep();t.ace_replaceRange(n.selStart,n.selEnd,"E"),t.ace_performSelectionChange([n.selStart[0],n.selStart[1]-1],n.selStart,!1),t.ace_performDocumentApplyAttributesToRange(n.selStart,n.selEnd,[["insertMediaLoading",JSON.stringify(e)]])}),"insertMediaLoading")};$(document).on("click",".btnMediaSize",(function(){$(".btnMediaSize").removeClass("on"),$(this).addClass("on"),$("#selectedSize").val($(this).text())})),$(document).on("click",".btnAlignDirection",(function(){$(".btnAlignDirection").removeClass("on"),$(this).addClass("on"),$("#selectedAlign").val($(this).data("value"))})),$("#file").change((()=>{$("#embedMediaSrc").val("")})),$("#insertEmbedMedia").click((()=>{const e=$("#embedMediaModal");e.hasClass("insertEmbedMedia-show")?e.removeClass("insertEmbedMedia-show"):e.addClass("insertEmbedMedia-show")})),$("#mobileToolbar .embededMedia").on("touchstart",(e=>{const t=$("#embedMediaModal");t.hasClass("insertEmbedMedia-show")?t.removeClass("insertEmbedMedia-show"):t.addClass("insertEmbedMedia-show")})),$("#doEmbedMedia").click((()=>{const e=require("ep_etherpad-lite/static/js/pad_editor").padeditor,t=$("#embedMediaSrc")[0].value,r=$("#selectedSize").val(),i=$("#selectedAlign").val(),a={url:escape(t),align:i,size:r};if($("#embedMediaModal").removeClass("insertEmbedMedia-show"),""===t){const e=$("#file")[0].files[0];return e?e.size>clientVars.ep_insert_media.settings.maxFileSize?($.gritter.add({title:"Error",text:"Maximum file size exceeded. (50 MB Limit)",class_name:"error"}),void $("#file").val(null)):void(e=>{const t=require("ep_etherpad-lite/static/js/pad_editor").padeditor,r=new FormData,i=$("#file")[0].files[0];r.append("file",i),$.ajax({url:`/p/${clientVars.padId}/pluginfw/ep_insert_media/upload`,type:"post",data:r,contentType:!1,processData:!1,beforeSend:()=>{n(e)},error:(e,t,n)=>{alert(e.status),alert(n)},success:n=>{const r=$('iframe[name="ace_outer"]').contents().find('iframe[name="ace_inner"]');if(n&&!1===n.error){if((e=>{switch(e.toLowerCase()){case".jpg":case".gif":case".bmp":case".png":case".jpeg":return!0}return!1})(n.fileType)){let i;i="s3"===n.type?`/p/getImage/${n.fileName}`:n.fileName,e.url=escape(i),t.ace.callWithAce((t=>{const n=t.ace_getRepFromSelector("#media_loading",r);n.length&&(t.ace_replaceRange(n[0][0],n[0][1],"E"),t.ace_performSelectionChange([n[0][0][0],n[0][0][1]-1],n[0][0],!1),t.ace_performDocumentApplyAttributesToRange(n[0][0],n[0][1],[["insertEmbedPicture",JSON.stringify(e)]]))}),"insertEmbedPicture")}if((e=>{switch(e.toLowerCase()){case".m4v":case".avi":case".mpg":case".mp4":case".webm":return!0}return!1})(n.fileType)){let i;i="s3"===n.type?`/p/getVideo/${n.fileName}`:n.fileName,e.url=escape(i),t.ace.callWithAce((t=>{const n=t.ace_getRepFromSelector("#media_loading",r);n.length&&(t.ace_replaceRange(n[0][0],n[0][1],"E"),t.ace_performSelectionChange([n[0][0][0],n[0][0][1]-1],n[0][0],!1),t.ace_performDocumentApplyAttributesToRange(n[0][0],n[0][1],[["insertEmbedVideo",JSON.stringify(e)]]))}),"insertEmbedVideo")}if((e=>{switch(e.toLowerCase()){case".mp3":case".ogg":case".m4a":case".flac":case".wav":case".wma":case".aac":return!0}return!1})(n.fileType)){let i;i="s3"===n.type?`/p/getMedia/${n.fileName}`:n.fileName,e.url=escape(i),t.ace.callWithAce((t=>{const n=t.ace_getRepFromSelector("#media_loading",r);n.length&&(t.ace_replaceRange(n[0][0],n[0][1],"E"),t.ace_performSelectionChange([n[0][0][0],n[0][0][1]-1],n[0][0],!1),t.ace_performDocumentApplyAttributesToRange(n[0][0],n[0][1],[["insertEmbedAudio",JSON.stringify(e)]]))}),"insertEmbedAudio")}$("#embedMediaModal").removeClass("insertEmbedMedia-show"),$("#file").val("")}else $.gritter.add({title:"Error",text:`ep_insert_media: ${n.error}`,sticky:!0,className:"error"})}})})(a):void $.gritter.add({title:"Error",text:"You didn't select or enter any media.",class_name:"error"})}const o=$('iframe[name="ace_outer"]').contents().find('iframe[name="ace_inner"]');n(a);const u=new URL(t),c=new Image;if(["http:","https:"].includes(u.protocol)){if($("#embedMediaSrc").val(""),["www.youtube.com","youtu.be","vimeo.com"].includes(u.host))return e.ace.callWithAce((e=>{const t=e.ace_getRepFromSelector("#media_loading",o);t.length&&(e.ace_replaceRange(t[0][0],t[0][1],"E"),e.ace_performSelectionChange([t[0][0][0],t[0][0][1]-1],t[0][0],!1),e.ace_performDocumentApplyAttributesToRange(t[0][0],t[0][1],[["embedMedia",JSON.stringify(a)]]))}),"embedMedia");c.onload=()=>e.ace.callWithAce((e=>{const t=e.ace_getRepFromSelector("#media_loading",o);t.length&&(e.ace_replaceRange(t[0][0],t[0][1],"E"),e.ace_performSelectionChange([t[0][0][0],t[0][0][1]-1],t[0][0],!1),e.ace_performDocumentApplyAttributesToRange(t[0][0],t[0][1],[["insertEmbedPicture",JSON.stringify(a)]]))}),"insertEmbedPicture"),c.onerror=()=>{$("#editorcontainerbox").hasClass("flex-layout")||$.gritter.add({title:"Error",text:"ep_insert_media: image is not supported.",sticky:!0,className:"error"})},c.src=t}})),$("#cancelEmbedMedia").click((()=>{$("#embedMediaModal").removeClass("insertEmbedMedia-show")}))},exports.postAceInit=(e,t)=>{const n=t.ace,r=require("ep_etherpad-lite/static/js/browser"),i=$('iframe[name="ace_outer"]').contents().find('iframe[name="ace_inner"]');(r.chrome||r.firefox)&&(i.contents().on("copy",(e=>{ln(e,n,i)})),i.contents().on("cut",(e=>{ln(e,n,i)})),i.contents().on("paste",(e=>{sn(e,0,i)})))};//# sourceMappingURL=ep_insert_media_bundle.js.map
